import{n as ne,r as b,c as T,d as re,w as ce,o as ue,a as de,b as L,e as N,f as p,t as C,u as I,g as y,h as D,i as Z,F as z,j as ee,T as ie,k as R,l as ve,m as fe,v as _e,p as pe,q as he,_ as me}from"./chunks/framework.8a3c402f.js";const te=e=>`2048_GAME_${e}`,ge=()=>({setItem:(u,v,h)=>{const _=()=>{typeof window<"u"&&window.localStorage.setItem(te(u),JSON.stringify(v))};h?_():ne(_)},getItem:u=>{if(typeof window<"u"){const v=window.localStorage.getItem(te(u));return v?JSON.parse(v):void 0}}});let we=1;const B=()=>we++;var w=(e=>(e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e))(w||{}),H=(e=>(e[e.NORMAL=1]="NORMAL",e[e.MERGE=2]="MERGE",e[e.NEW=3]="NEW",e))(H||{});const ae=(e,l)=>({id:B(),value:e,state:l}),oe=e=>{const l=[];for(let u=0;u<e;u++){const v=[];for(let h=0;h<e;h++)v.push(ae(0,1));l.push(v)}return l},A=(e,l,u,v,h)=>{const _=e[l][u],S=e[v][h];e[l][u]=S,e[v][h]=_},ye=e=>e.map(l=>l.map(u=>({...u,state:1}))),Ee=e=>{const l=b(0),u=b(oe(e)),v=[],h=T(()=>u.value.some(r=>r.some(n=>n.value===0))),_=T(()=>{if(h.value)return!1;const r=u.value;for(let n=0;n<e;n++)for(let t=1;t<e;t++)if(r[t][n].value===r[t-1][n].value)return!1;for(let n=0;n<e;n++)for(let t=1;t<e;t++)if(r[n][t].value===r[n][t-1].value)return!1;return!0}),S=T(()=>{const r=[],n=u.value;for(let t=0;t<e;t++)for(let f=0;f<e;f++)if(n[t][f].value!==0){const o={...n[t][f],x:f,y:t};r.push(o)}return r}),$=()=>{if(v.length){const r=v.pop();u.value=r.data,l.value=r.score}},G=r=>{let n=!1;v.push({score:l.value,data:u.value});const t=ye(u.value);let f=0;switch(r){case 1:for(let o=0;o<e;o++){let d=-1,s=-1,g=-1;for(let a=0;a<e;a++)t[a][o].value===d?(t[s][o].state=2,t[s][o].value+=d,f+=t[s][o].value,t[a][o].value=0,d=-1,s=-1,n=!0):t[a][o].value!==0&&(s=++g,d=t[a][o].value,s!==a&&(A(t,a,o,s,o),n=!0))}break;case 2:for(let o=0;o<e;o++){let d=-1,s=-1,g=e;for(let a=e-1;a>=0;a--)t[a][o].value===d?(t[s][o].state=2,t[s][o].value+=d,f+=t[s][o].value,t[a][o].value=0,d=-1,s=-1,n=!0):t[a][o].value!==0&&(s=--g,d=t[a][o].value,s!==a&&(A(t,a,o,s,o),n=!0))}break;case 3:for(let o=0;o<e;o++){let d=-1,s=-1,g=-1;for(let a=0;a<e;a++)t[o][a].value===d?(t[o][s].state=2,t[o][s].value+=d,f+=t[o][s].value,t[o][a].value=0,d=-1,s=-1,n=!0):t[o][a].value!==0&&(s=++g,d=t[o][a].value,s!==a&&(A(t,o,a,o,s),n=!0))}break;case 4:for(let o=0;o<e;o++){let d=-1,s=-1,g=e;for(let a=e-1;a>=0;a--)t[o][a].value===d?(t[o][s].state=2,t[o][s].value+=d,f+=t[o][s].value,t[o][a].value=0,d=-1,s=-1,n=!0):t[o][a].value!==0&&(s=--g,d=t[o][a].value,s!==a&&(A(t,o,a,o,s),n=!0))}break}u.value=t,l.value+=f,h.value&&n&&M()},M=()=>{const r=[];for(let o=0;o<e;o++)for(let d=0;d<e;d++)u.value[o][d].value===0&&r.push([o,d]);const n=Math.floor(Math.random()*r.length),[t,f]=r[n];u.value[t][f]=ae(Math.random()<.9?2:4,3)};return{gridData:u,cells:S,score:l,isEnd:_,move:G,undo:$,init:r=>{r&&(e=r),l.value=0,v.length=0,u.value=oe(e)},start:()=>{M(),M()}}},K=e=>(pe("data-v-561a1d26"),e=e(),he(),e),xe={class:"game"},Ie={class:"grid"},be={class:"grid-header"},ke={class:"controls"},Le=K(()=>p("h3",null,"2048",-1)),Ne=K(()=>p("p",{class:"label"},C("SCORE"),-1)),Te={class:"value"},Se=K(()=>p("p",{class:"label"},"BEST",-1)),Ge={class:"value"},Me={class:"row"},Re={class:"dialog"},$e=K(()=>p("p",{class:"text"},"GAME OVER",-1)),Oe=[$e],qe=re({__name:"Grid",setup(e){const l=b(4),{cells:u,score:v,isEnd:h,move:_,undo:S,init:$,start:G}=Ee(l.value),{setItem:M,getItem:U}=ge(),O=T(()=>`size${l.value}_best`),r=b(U(O.value)??0),n=b({id:B(),value:0});ce(v,(c,i)=>{n.value.id=B(),n.value.value=c-i,c>r.value&&(r.value=c,M(O.value,r.value))});const t=8,f=b(0),o=T(()=>(f.value-(l.value+1)*t)/l.value),d=T(()=>`
    display: grid;
    grid-template-columns: repeat(${l.value}, 1fr);
    grid-template-rows: repeat(${l.value}, 1fr);
    gap: ${t}px;
    padding: ${t}px;
  `),s=c=>{const i=o.value,{x:E,y:x}=c,k=i*x+t*(x+1),q=i*E+t*(E+1);return`
    width: ${i}px;
    height: ${i}px;
    top: ${k}px;
    left: ${q}px;
    font-size: ${Math.round(i/2.5)}px;
  `},g=()=>{console.log("d"),r.value=U(O.value)??0,$(l.value),G()},a=b();let W=0,F=0,P=!1,V;const X=c=>{W=c.changedTouches[0].clientX,F=c.changedTouches[0].clientY},Y=c=>{c.preventDefault()},J=c=>{const i=c.changedTouches[0].clientX,E=c.changedTouches[0].clientY,x=Math.abs(i-W),k=Math.abs(E-F);Math.max(x,k)<=10||(x>k?i>W?_(w.RIGHT):_(w.LEFT):E>F?_(w.DOWN):_(w.UP))},j=c=>{if(P)return;P=!0;const i=c.altKey||c.ctrlKey||c.metaKey||c.shiftKey;if(!(h.value||i))switch(c.code){case"ArrowUp":_(w.UP);break;case"ArrowDown":_(w.DOWN);break;case"ArrowLeft":_(w.LEFT);break;case"ArrowRight":_(w.RIGHT);break}},Q=()=>{P=!1};ue(()=>{var c;if(document.addEventListener("keydown",j,!1),document.addEventListener("keyup",Q,!1),a.value){const i=a.value;i.addEventListener("touchstart",X,!1),i.addEventListener("touchmove",Y,!1),i.addEventListener("touchend",J,!1),V=new ResizeObserver(()=>{f.value=i.clientWidth}),V.observe(i),(c=a.value)==null||c.scrollIntoView({behavior:"smooth"})}}),de(()=>{if(document.removeEventListener("keydown",j,!1),document.removeEventListener("keyup",Q,!1),a.value){const c=a.value;c.removeEventListener("touchstart",X,!1),c.removeEventListener("touchmove",Y,!1),c.removeEventListener("touchend",J,!1),V.disconnect()}});const se=()=>{$(),G()};return G(),(c,i)=>{const E=R("q-icon"),x=R("q-select"),k=R("q-space"),q=R("q-btn"),le=R("q-btn-group");return L(),N("div",xe,[p("div",Ie,[p("header",be,[p("div",ke,[Le,p("div",null,[Ne,p("p",Te,C(I(v)),1)]),p("div",null,[Se,p("p",Ge,C(r.value),1)])]),p("div",Me,[y(x,{modelValue:l.value,"onUpdate:modelValue":[i[0]||(i[0]=m=>l.value=m),g],options:[3,4,5,6],behavior:"menu"},{prepend:D(()=>[y(E,{name:"lens_blur"})]),_:1},8,["modelValue"]),y(k),y(le,null,{default:D(()=>[y(q,{icon:"refresh",onClick:se}),y(q,{icon:"undo",onClick:I(S)},null,8,["onClick"])]),_:1})])]),p("main",{class:"grid-main",ref_key:"gridRef",ref:a,style:Z(I(d))},[(L(!0),N(z,null,ee(l.value*l.value,m=>(L(),N("div",{class:"cell-placeholder",key:m}))),128)),(L(!0),N(z,null,ee(I(u),m=>(L(),N("div",{class:ve(["cell",{[`cell-${m.value}`]:!0,"cell-merge":m.state===I(H).MERGE,"cell-new":m.state===I(H).NEW}]),key:m.id,style:Z(s(m))},C(m.value),7))),128)),y(ie,{name:"fade"},{default:D(()=>[fe(p("div",Re,Oe,512),[[_e,I(h)]])]),_:1})],4)])])}}});const Ae=me(qe,[["__scopeId","data-v-561a1d26"]]),Ce={class:"game"},We=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"game/2048.md","filePath":"game/2048.md","lastUpdated":1683456235000}'),Ke={name:"game/2048.md"},Fe=Object.assign(Ke,{setup(e){return(l,u)=>(L(),N("div",null,[p("div",Ce,[y(Ae)])]))}});export{We as __pageData,Fe as default};
