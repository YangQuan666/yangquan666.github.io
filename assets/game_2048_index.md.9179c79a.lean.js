import{a as ne,P as x,r as T,u as re,q as ce,A as ue,b as de,v as k,c as L,F as h,X as K,N,T as w,O as C,j as Q,d as z,H as ee,$ as ve,M as $,z as ie,Z as fe,E as _e,e as he,f as pe,_ as me}from"./chunks/framework.2325a593.js";const te=e=>`2048_GAME_${e}`,ge=()=>({setItem:(u,i,m)=>{const f=()=>{typeof window<"u"&&window.localStorage.setItem(te(u),JSON.stringify(i))};m?f():ne(f)},getItem:u=>{if(typeof window<"u"){const i=window.localStorage.getItem(te(u));return i?JSON.parse(i):void 0}}});let Ee=1;const V=()=>Ee++;var E=(e=>(e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e))(E||{}),Y=(e=>(e[e.NORMAL=1]="NORMAL",e[e.MERGE=2]="MERGE",e[e.NEW=3]="NEW",e))(Y||{});const oe=(e,l)=>({id:V(),value:e,state:l}),ae=e=>{const l=[];for(let u=0;u<e;u++){const i=[];for(let m=0;m<e;m++)i.push(oe(0,1));l.push(i)}return l},P=(e,l,u,i,m)=>{const f=e[l][u],M=e[i][m];e[l][u]=M,e[i][m]=f},we=e=>e.map(l=>l.map(u=>({...u,state:1}))),ye=e=>{const l=x(0),u=x(ae(e)),i=[],m=T(()=>u.value.some(r=>r.some(n=>n.value===0))),f=T(()=>{if(m.value)return!1;const r=u.value;for(let n=0;n<e;n++)for(let a=1;a<e;a++)if(r[a][n].value===r[a-1][n].value)return!1;for(let n=0;n<e;n++)for(let a=1;a<e;a++)if(r[n][a].value===r[n][a-1].value)return!1;return!0}),M=T(()=>{const r=[],n=u.value;for(let a=0;a<e;a++)for(let _=0;_<e;_++)if(n[a][_].value!==0){const t={...n[a][_],x:_,y:a};r.push(t)}return r}),q=()=>{if(i.length){const r=i.pop();u.value=r.data,l.value=r.score}},G=r=>{let n=!1;i.push({score:l.value,data:u.value});const a=we(u.value);let _=0;switch(r){case 1:for(let t=0;t<e;t++){let d=-1,s=-1,p=-1;for(let o=0;o<e;o++)a[o][t].value===d?(a[s][t].state=2,a[s][t].value+=d,_+=a[s][t].value,a[o][t].value=0,d=-1,s=-1,n=!0):a[o][t].value!==0&&(s=++p,d=a[o][t].value,s!==o&&(P(a,o,t,s,t),n=!0))}break;case 2:for(let t=0;t<e;t++){let d=-1,s=-1,p=e;for(let o=e-1;o>=0;o--)a[o][t].value===d?(a[s][t].state=2,a[s][t].value+=d,_+=a[s][t].value,a[o][t].value=0,d=-1,s=-1,n=!0):a[o][t].value!==0&&(s=--p,d=a[o][t].value,s!==o&&(P(a,o,t,s,t),n=!0))}break;case 3:for(let t=0;t<e;t++){let d=-1,s=-1,p=-1;for(let o=0;o<e;o++)a[t][o].value===d?(a[t][s].state=2,a[t][s].value+=d,_+=a[t][s].value,a[t][o].value=0,d=-1,s=-1,n=!0):a[t][o].value!==0&&(s=++p,d=a[t][o].value,s!==o&&(P(a,t,o,t,s),n=!0))}break;case 4:for(let t=0;t<e;t++){let d=-1,s=-1,p=e;for(let o=e-1;o>=0;o--)a[t][o].value===d?(a[t][s].state=2,a[t][s].value+=d,_+=a[t][s].value,a[t][o].value=0,d=-1,s=-1,n=!0):a[t][o].value!==0&&(s=--p,d=a[t][o].value,s!==o&&(P(a,t,o,t,s),n=!0))}break}u.value=a,l.value+=_,m.value&&n&&R()},R=()=>{const r=[];for(let t=0;t<e;t++)for(let d=0;d<e;d++)u.value[t][d].value===0&&r.push([t,d]);const n=Math.floor(Math.random()*r.length),[a,_]=r[n];u.value[a][_]=oe(Math.random()<.9?2:4,3)};return{gridData:u,cells:M,score:l,isEnd:f,move:G,undo:q,init:r=>{r&&(e=r),l.value=0,i.length=0,u.value=ae(e)},start:()=>{R(),R()}}},W=e=>(he("data-v-1195edb8"),e=e(),pe(),e),be={class:"game"},xe={class:"grid"},Ie={class:"grid-header"},Ne={class:"controls"},ke=W(()=>h("h3",null,"2048",-1)),Le=W(()=>h("p",{class:"label"},K("SCORE"),-1)),Te={class:"value"},Me=W(()=>h("p",{class:"label"},"BEST",-1)),Ge={class:"value"},Re={class:"row"},$e={class:"dialog"},Oe=W(()=>h("p",{class:"text"},"GAME OVER",-1)),qe=[Oe],O=8,Se=re({__name:"Grid",setup(e){const l=x(4),{cells:u,score:i,isEnd:m,move:f,undo:M,init:q,start:G}=ye(l.value),{setItem:R,getItem:F}=ge(),S=T(()=>`size${l.value}_best`),r=x(F(S.value)??0),n=x({id:V(),value:0});ce(i,(c,v)=>{n.value.id=V(),n.value.value=c-v,c>r.value&&(r.value=c,R(S.value,r.value))});const a=x(0),_=T(()=>(a.value-(l.value+1)*O)/l.value),t=T(()=>`
    display: grid;
    grid-template-columns: repeat(${l.value}, 1fr);
    grid-template-rows: repeat(${l.value}, 1fr);
    gap: ${O}px;
    padding: ${O}px;
  `),d=c=>{const v=_.value,{x:y,y:b}=c,I=v*b+O*(b+1),A=v*y+O*(y+1);return`
    width: ${v}px;
    height: ${v}px;
    top: ${I}px;
    left: ${A}px;
    font-size: ${Math.round(v/2.5)}px;
  `},s=()=>{console.log("d"),r.value=F(S.value)??0,q(l.value),G()},p=x();let o=0,U=0,H=!1,X;const D=c=>{o=c.changedTouches[0].clientX,U=c.changedTouches[0].clientY},J=c=>{c.preventDefault()},j=c=>{const v=c.changedTouches[0].clientX,y=c.changedTouches[0].clientY,b=Math.abs(v-o),I=Math.abs(y-U);Math.max(b,I)<=10||(b>I?v>o?f(E.RIGHT):f(E.LEFT):y>U?f(E.DOWN):f(E.UP))},Z=c=>{if(H)return;H=!0;const v=c.altKey||c.ctrlKey||c.metaKey||c.shiftKey;if(!(m.value||v))switch(c.code){case"ArrowUp":f(E.UP);break;case"ArrowDown":f(E.DOWN);break;case"ArrowLeft":f(E.LEFT);break;case"ArrowRight":f(E.RIGHT);break}},B=()=>{H=!1};ue(()=>{var c;if(document.addEventListener("keydown",Z,!1),document.addEventListener("keyup",B,!1),p.value){const v=p.value;v.addEventListener("touchstart",D,!1),v.addEventListener("touchmove",J,!1),v.addEventListener("touchend",j,!1),X=new ResizeObserver(()=>{a.value=v.clientWidth}),X.observe(v),(c=p.value)==null||c.scrollIntoView({behavior:"smooth"})}}),de(()=>{if(document.removeEventListener("keydown",Z,!1),document.removeEventListener("keyup",B,!1),p.value){const c=p.value;c.removeEventListener("touchstart",D,!1),c.removeEventListener("touchmove",J,!1),c.removeEventListener("touchend",j,!1),X.disconnect()}});const se=()=>{q(),G()};return G(),(c,v)=>{const y=$("q-icon"),b=$("q-select"),I=$("q-space"),A=$("q-btn"),le=$("q-btn-group");return k(),L("div",be,[h("div",xe,[h("header",Ie,[h("div",Ne,[ke,h("div",null,[Le,h("p",Te,K(N(i)),1)]),h("div",null,[Me,h("p",Ge,K(r.value),1)])]),h("div",Re,[w(b,{modelValue:l.value,"onUpdate:modelValue":[v[0]||(v[0]=g=>l.value=g),s],options:[3,4,5,6],behavior:"menu"},{prepend:C(()=>[w(y,{name:"lens_blur"})]),_:1},8,["modelValue"]),w(I),w(le,null,{default:C(()=>[w(A,{icon:"refresh",onClick:se}),w(A,{icon:"undo",onClick:N(M)},null,8,["onClick"])]),_:1})])]),h("main",{class:"grid-main",ref_key:"gridRef",ref:p,style:Q(t.value)},[(k(!0),L(z,null,ee(l.value*l.value,g=>(k(),L("div",{class:"cell-placeholder",key:g}))),128)),(k(!0),L(z,null,ee(N(u),g=>(k(),L("div",{class:ie(["cell",{[`cell-${g.value}`]:!0,"cell-merge":g.state===N(Y).MERGE,"cell-new":g.state===N(Y).NEW}]),key:g.id,style:Q(d(g))},K(g.value),7))),128)),w(ve,{name:"fade"},{default:C(()=>[fe(h("div",$e,qe,512),[[_e,N(m)]])]),_:1})],4)])])}}});const Ae=me(Se,[["__scopeId","data-v-1195edb8"]]),Pe={class:"game"},Fe=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"game/2048/index.md","filePath":"game/2048/index.md","lastUpdated":1683879324000}'),Ke={name:"game/2048/index.md"},Ue=Object.assign(Ke,{setup(e){return(l,u)=>(k(),L("div",null,[h("div",Pe,[w(Ae)])]))}});export{Fe as __pageData,Ue as default};
