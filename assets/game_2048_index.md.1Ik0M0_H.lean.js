import{n as ne,r as I,c as T,q as re,w as ce,a as ue,u as de,B as G,C as L,D as N,F as p,L as K,A as k,I as E,H as P,a4 as Z,N as z,E as ee,T as ie,V as ve,f as fe,z as he,a5 as pe,a6 as me,a7 as _e}from"./chunks/framework.YixF1Q1-.js";const te=e=>`2048_GAME_${e}`,ge=()=>({setItem:(u,v,_)=>{const f=()=>{typeof window<"u"&&window.localStorage.setItem(te(u),JSON.stringify(v))};_?f():ne(f)},getItem:u=>{if(typeof window<"u"){const v=window.localStorage.getItem(te(u));return v?JSON.parse(v):void 0}}});let we=1;const B=()=>we++;var w=(e=>(e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e))(w||{}),H=(e=>(e[e.NORMAL=1]="NORMAL",e[e.MERGE=2]="MERGE",e[e.NEW=3]="NEW",e))(H||{});const oe=(e,l)=>({id:B(),value:e,state:l}),ae=e=>{const l=[];for(let u=0;u<e;u++){const v=[];for(let _=0;_<e;_++)v.push(oe(0,1));l.push(v)}return l},C=(e,l,u,v,_)=>{const f=e[l][u],S=e[v][_];e[l][u]=S,e[v][_]=f},Ee=e=>e.map(l=>l.map(u=>({...u,state:1}))),ye=e=>{const l=I(0),u=I(ae(e)),v=[],_=T(()=>u.value.some(r=>r.some(n=>n.value===0))),f=T(()=>{if(_.value)return!1;const r=u.value;for(let n=0;n<e;n++)for(let a=1;a<e;a++)if(r[a][n].value===r[a-1][n].value)return!1;for(let n=0;n<e;n++)for(let a=1;a<e;a++)if(r[n][a].value===r[n][a-1].value)return!1;return!0}),S=T(()=>{const r=[],n=u.value;for(let a=0;a<e;a++)for(let h=0;h<e;h++)if(n[a][h].value!==0){const t={...n[a][h],x:h,y:a};r.push(t)}return r}),O=()=>{if(v.length){const r=v.pop();u.value=r.data,l.value=r.score}},M=r=>{let n=!1;v.push({score:l.value,data:u.value});const a=Ee(u.value);let h=0;switch(r){case 1:for(let t=0;t<e;t++){let d=-1,s=-1,m=-1;for(let o=0;o<e;o++)a[o][t].value===d?(a[s][t].state=2,a[s][t].value+=d,h+=a[s][t].value,a[o][t].value=0,d=-1,s=-1,n=!0):a[o][t].value!==0&&(s=++m,d=a[o][t].value,s!==o&&(C(a,o,t,s,t),n=!0))}break;case 2:for(let t=0;t<e;t++){let d=-1,s=-1,m=e;for(let o=e-1;o>=0;o--)a[o][t].value===d?(a[s][t].state=2,a[s][t].value+=d,h+=a[s][t].value,a[o][t].value=0,d=-1,s=-1,n=!0):a[o][t].value!==0&&(s=--m,d=a[o][t].value,s!==o&&(C(a,o,t,s,t),n=!0))}break;case 3:for(let t=0;t<e;t++){let d=-1,s=-1,m=-1;for(let o=0;o<e;o++)a[t][o].value===d?(a[t][s].state=2,a[t][s].value+=d,h+=a[t][s].value,a[t][o].value=0,d=-1,s=-1,n=!0):a[t][o].value!==0&&(s=++m,d=a[t][o].value,s!==o&&(C(a,t,o,t,s),n=!0))}break;case 4:for(let t=0;t<e;t++){let d=-1,s=-1,m=e;for(let o=e-1;o>=0;o--)a[t][o].value===d?(a[t][s].state=2,a[t][s].value+=d,h+=a[t][s].value,a[t][o].value=0,d=-1,s=-1,n=!0):a[t][o].value!==0&&(s=--m,d=a[t][o].value,s!==o&&(C(a,t,o,t,s),n=!0))}break}u.value=a,l.value+=h,_.value&&n&&R()},R=()=>{const r=[];for(let t=0;t<e;t++)for(let d=0;d<e;d++)u.value[t][d].value===0&&r.push([t,d]);const n=Math.floor(Math.random()*r.length),[a,h]=r[n];u.value[a][h]=oe(Math.random()<.9?2:4,3)};return{gridData:u,cells:S,score:l,isEnd:f,move:M,undo:O,init:r=>{r&&(e=r),l.value=0,v.length=0,u.value=ae(e)},start:()=>{R(),R()}}},U=e=>(pe("data-v-1195edb8"),e=e(),me(),e),xe={class:"game"},Ie={class:"grid"},be={class:"grid-header"},ke={class:"controls"},Le=U(()=>p("h3",null,"2048",-1)),Ne=U(()=>p("p",{class:"label"},K("SCORE"),-1)),Te={class:"value"},Se=U(()=>p("p",{class:"label"},"BEST",-1)),Me={class:"value"},Re={class:"row"},Ge={class:"dialog"},$e=U(()=>p("p",{class:"text"},"GAME OVER",-1)),Oe=[$e],$=8,qe=re({__name:"Grid",setup(e){const l=I(4),{cells:u,score:v,isEnd:_,move:f,undo:S,init:O,start:M}=ye(l.value),{setItem:R,getItem:W}=ge(),q=T(()=>`size${l.value}_best`),r=I(W(q.value)??0),n=I({id:B(),value:0});ce(v,(c,i)=>{n.value.id=B(),n.value.value=c-i,c>r.value&&(r.value=c,R(q.value,r.value))});const a=I(0),h=T(()=>(a.value-(l.value+1)*$)/l.value),t=T(()=>`
    display: grid;
    grid-template-columns: repeat(${l.value}, 1fr);
    grid-template-rows: repeat(${l.value}, 1fr);
    gap: ${$}px;
    padding: ${$}px;
  `),d=c=>{const i=h.value,{x:y,y:x}=c,b=i*x+$*(x+1),A=i*y+$*(y+1);return`
    width: ${i}px;
    height: ${i}px;
    top: ${b}px;
    left: ${A}px;
    font-size: ${Math.round(i/2.5)}px;
  `},s=()=>{console.log("d"),r.value=W(q.value)??0,O(l.value),M()},m=I();let o=0,V=0,D=!1,F;const X=c=>{o=c.changedTouches[0].clientX,V=c.changedTouches[0].clientY},Y=c=>{c.preventDefault()},J=c=>{const i=c.changedTouches[0].clientX,y=c.changedTouches[0].clientY,x=Math.abs(i-o),b=Math.abs(y-V);Math.max(x,b)<=10||(x>b?i>o?f(w.RIGHT):f(w.LEFT):y>V?f(w.DOWN):f(w.UP))},j=c=>{if(D)return;D=!0;const i=c.altKey||c.ctrlKey||c.metaKey||c.shiftKey;if(!(_.value||i))switch(c.code){case"ArrowUp":f(w.UP);break;case"ArrowDown":f(w.DOWN);break;case"ArrowLeft":f(w.LEFT);break;case"ArrowRight":f(w.RIGHT);break}},Q=()=>{D=!1};ue(()=>{var c;if(document.addEventListener("keydown",j,!1),document.addEventListener("keyup",Q,!1),m.value){const i=m.value;i.addEventListener("touchstart",X,!1),i.addEventListener("touchmove",Y,!1),i.addEventListener("touchend",J,!1),F=new ResizeObserver(()=>{a.value=i.clientWidth}),F.observe(i),(c=m.value)==null||c.scrollIntoView({behavior:"smooth"})}}),de(()=>{if(document.removeEventListener("keydown",j,!1),document.removeEventListener("keyup",Q,!1),m.value){const c=m.value;c.removeEventListener("touchstart",X,!1),c.removeEventListener("touchmove",Y,!1),c.removeEventListener("touchend",J,!1),F.disconnect()}});const se=()=>{O(),M()};return M(),(c,i)=>{const y=G("q-icon"),x=G("q-select"),b=G("q-space"),A=G("q-btn"),le=G("q-btn-group");return L(),N("div",xe,[p("div",Ie,[p("header",be,[p("div",ke,[Le,p("div",null,[Ne,p("p",Te,K(k(v)),1)]),p("div",null,[Se,p("p",Me,K(r.value),1)])]),p("div",Re,[E(x,{modelValue:l.value,"onUpdate:modelValue":[i[0]||(i[0]=g=>l.value=g),s],options:[3,4,5,6],behavior:"menu"},{prepend:P(()=>[E(y,{name:"lens_blur"})]),_:1},8,["modelValue"]),E(b),E(le,null,{default:P(()=>[E(A,{icon:"refresh",onClick:se}),E(A,{icon:"undo",onClick:k(S)},null,8,["onClick"])]),_:1})])]),p("main",{class:"grid-main",ref_key:"gridRef",ref:m,style:Z(t.value)},[(L(!0),N(z,null,ee(l.value*l.value,g=>(L(),N("div",{class:"cell-placeholder",key:g}))),128)),(L(!0),N(z,null,ee(k(u),g=>(L(),N("div",{class:ve(["cell",{[`cell-${g.value}`]:!0,"cell-merge":g.state===k(H).MERGE,"cell-new":g.state===k(H).NEW}]),key:g.id,style:Z(d(g))},K(g.value),7))),128)),E(ie,{name:"fade"},{default:P(()=>[fe(p("div",Ge,Oe,512),[[he,k(_)]])]),_:1})],4)])])}}}),Ae=_e(qe,[["__scopeId","data-v-1195edb8"]]),Ce={class:"game"},We=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"game/2048/index.md","filePath":"game/2048/index.md","lastUpdated":1683879324000}'),Ke={name:"game/2048/index.md"},Ve=Object.assign(Ke,{setup(e){return(l,u)=>(L(),N("div",null,[p("div",Ce,[E(Ae)])]))}});export{We as __pageData,Ve as default};
