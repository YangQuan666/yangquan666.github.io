import{n as ce,r as L,c as N,d as ae,o as E,a as w,b as i,t as b,w as D,v as P,e as re,f as ue,g as de,u as x,h as I,i as V,j as ee,F as B,k as te,T as ie,l as C,m as ve}from"./app.b1d86492.js";const se=e=>`2048_GAME_${e}`,_e=()=>({setItem:(r,_,m)=>{const f=()=>{window.localStorage.setItem(se(r),JSON.stringify(_))};m?f():ce(f)},getItem:r=>{const _=window.localStorage.getItem(se(r));return _?JSON.parse(_):void 0}});let he=1;const X=()=>he++;var y=(e=>(e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e))(y||{}),Y=(e=>(e[e.NORMAL=1]="NORMAL",e[e.MERGE=2]="MERGE",e[e.NEW=3]="NEW",e))(Y||{});const le=(e,a)=>({id:X(),value:e,state:a}),oe=e=>{const a=[];for(let r=0;r<e;r++){const _=[];for(let m=0;m<e;m++)_.push(le(0,1));a.push(_)}return a},q=(e,a,r,_,m)=>{const f=e[a][r],S=e[_][m];e[a][r]=S,e[_][m]=f},fe=e=>e.map(a=>a.map(r=>({...r,state:1}))),me=e=>{const a=L(0),r=L(oe(e)),_=[],m=N(()=>r.value.some(c=>c.some(l=>l.value===0))),f=N(()=>{if(m.value)return!1;const c=r.value;for(let l=0;l<e;l++)for(let t=1;t<e;t++)if(c[t][l].value===c[t-1][l].value)return!1;for(let l=0;l<e;l++)for(let t=1;t<e;t++)if(c[l][t].value===c[l][t-1].value)return!1;return!0}),S=N(()=>{const c=[],l=r.value;for(let t=0;t<e;t++)for(let h=0;h<e;h++)if(l[t][h].value!==0){const s={...l[t][h],x:h,y:t};c.push(s)}return c}),M=()=>{if(_.length){const c=_.pop();r.value=c.data,a.value=c.score}},R=c=>{let l=!1;_.push({score:a.value,data:r.value});const t=fe(r.value);let h=0;switch(c){case 1:for(let s=0;s<e;s++){let d=-1,n=-1,g=-1;for(let o=0;o<e;o++)t[o][s].value===d?(t[n][s].state=2,t[n][s].value+=d,h+=t[n][s].value,t[o][s].value=0,d=-1,n=-1,l=!0):t[o][s].value!==0&&(n=++g,d=t[o][s].value,n!==o&&(q(t,o,s,n,s),l=!0))}break;case 2:for(let s=0;s<e;s++){let d=-1,n=-1,g=e;for(let o=e-1;o>=0;o--)t[o][s].value===d?(t[n][s].state=2,t[n][s].value+=d,h+=t[n][s].value,t[o][s].value=0,d=-1,n=-1,l=!0):t[o][s].value!==0&&(n=--g,d=t[o][s].value,n!==o&&(q(t,o,s,n,s),l=!0))}break;case 3:for(let s=0;s<e;s++){let d=-1,n=-1,g=-1;for(let o=0;o<e;o++)t[s][o].value===d?(t[s][n].state=2,t[s][n].value+=d,h+=t[s][n].value,t[s][o].value=0,d=-1,n=-1,l=!0):t[s][o].value!==0&&(n=++g,d=t[s][o].value,n!==o&&(q(t,s,o,s,n),l=!0))}break;case 4:for(let s=0;s<e;s++){let d=-1,n=-1,g=e;for(let o=e-1;o>=0;o--)t[s][o].value===d?(t[s][n].state=2,t[s][n].value+=d,h+=t[s][n].value,t[s][o].value=0,d=-1,n=-1,l=!0):t[s][o].value!==0&&(n=--g,d=t[s][o].value,n!==o&&(q(t,s,o,s,n),l=!0))}break}r.value=t,a.value+=h,m.value&&l&&G()},G=()=>{const c=[];for(let s=0;s<e;s++)for(let d=0;d<e;d++)r.value[s][d].value===0&&c.push([s,d]);const l=Math.floor(Math.random()*c.length),[t,h]=c[l];r.value[t][h]=le(Math.random()<.9?2:4,3)};return{gridData:r,cells:S,score:a,isEnd:f,move:R,undo:M,init:c=>{c&&(e=c),a.value=0,_.length=0,r.value=oe(e)},start:()=>{G(),G()}}},pe={class:"heading"},ge=i("h1",{class:"title"},"2048",-1),ye={class:"scores"},Ee={class:"score score-now"},we=i("p",{class:"label"},b("SCORE"),-1),be={class:"value"},xe={class:"score"},Ie=i("p",{class:"label"},"BEST",-1),ke={class:"value"},$e=ae({__name:"Heading",props:{score:null,bestScore:null,scoreIncrement:null},setup(e){const a=e;return(r,_)=>(E(),w("div",pe,[ge,i("div",ye,[i("div",Ee,[we,i("p",be,b(a.score),1),D((E(),w("span",{class:"score-increment",key:a.scoreIncrement.id}," +"+b(a.scoreIncrement.value),1)),[[P,a.scoreIncrement.value>0]])]),i("div",xe,[Ie,i("p",ke,b(a.bestScore),1)])])]))}});const Te={class:"heading"},Le=i("h1",{class:"title"},"2048",-1),Ne={class:"scores"},Se={class:"score score-now"},Re=i("p",{class:"label"},b("SCORE"),-1),Ge={class:"value"},Me={class:"score"},Oe=i("p",{class:"label"},"BEST",-1),Ce={class:"value"},qe={class:"game"},Ae={class:"grid"},Ke={class:"grid-header"},Ue={class:"controls"},We={class:"dialog"},Fe=i("p",{class:"text"},"GAME OVER",-1),He=[Fe],Ve=ae({__name:"Grid",setup(e){const a=L(4),{cells:r,score:_,isEnd:m,move:f,undo:S,init:M,start:R}=me(a.value),{setItem:G,getItem:A}=_e(),O=N(()=>`size${a.value}_best`),c=L(A(O.value)??0),l=L({id:X(),value:0});re(_,(u,v)=>{l.value.id=X(),l.value.value=u-v,u>c.value&&(c.value=u,G(O.value,c.value))});const t=8,h=L(0),s=N(()=>(h.value-(a.value+1)*t)/a.value),d=N(()=>`
    display: grid;
    grid-template-columns: repeat(${a.value}, 1fr);
    grid-template-rows: repeat(${a.value}, 1fr);
    gap: ${t}px;
    padding: ${t}px;
  `),n=u=>{const v=s.value,{x:k,y:$}=u,T=v*$+t*($+1),H=v*k+t*(k+1);return`
    width: ${v}px;
    height: ${v}px;
    top: ${T}px;
    left: ${H}px;
    font-size: ${Math.round(v/2.5)}px;
  `},g=()=>{console.log("d"),c.value=A(O.value)??0,M(a.value),R()},o=L();let K=0,U=0,W=!1,F;const J=u=>{K=u.changedTouches[0].clientX,U=u.changedTouches[0].clientY},j=u=>{u.preventDefault()},Q=u=>{const v=u.changedTouches[0].clientX,k=u.changedTouches[0].clientY,$=Math.abs(v-K),T=Math.abs(k-U);Math.max($,T)<=10||($>T?v>K?f(y.RIGHT):f(y.LEFT):k>U?f(y.DOWN):f(y.UP))},Z=u=>{if(W)return;W=!0;const v=u.altKey||u.ctrlKey||u.metaKey||u.shiftKey;if(!(m.value||v))switch(u.code){case"ArrowUp":f(y.UP);break;case"ArrowDown":f(y.DOWN);break;case"ArrowLeft":f(y.LEFT);break;case"ArrowRight":f(y.RIGHT);break}},z=()=>{W=!1};ue(()=>{var u;if(document.addEventListener("keydown",Z,!1),document.addEventListener("keyup",z,!1),o.value){const v=o.value;v.addEventListener("touchstart",J,!1),v.addEventListener("touchmove",j,!1),v.addEventListener("touchend",Q,!1),F=new ResizeObserver(()=>{h.value=v.clientWidth}),F.observe(v),(u=o.value)==null||u.scrollIntoView({behavior:"smooth"})}}),de(()=>{if(document.removeEventListener("keydown",Z,!1),document.removeEventListener("keyup",z,!1),o.value){const u=o.value;u.removeEventListener("touchstart",J,!1),u.removeEventListener("touchmove",j,!1),u.removeEventListener("touchend",Q,!1),F.disconnect()}});const ne=()=>{M(),R()};return R(),(u,v)=>{const k=C("q-icon"),$=C("q-select"),T=C("q-btn"),H=C("q-btn-group");return E(),w(B,null,[i("div",Te,[Le,i("div",Ne,[i("div",Se,[Re,i("p",Ge,b(x(_)),1),D((E(),w("span",{class:"score-increment",key:l.value.id}," +"+b(l.value.value),1)),[[P,l.value.value>0]])]),i("div",Me,[Oe,i("p",Ce,b(c.value),1)])])]),i("div",qe,[i("div",Ae,[i("header",Ke,[I($e,{score:x(_),"score-increment":l.value,"best-score":c.value},null,8,["score","score-increment","best-score"]),i("div",Ue,[I($,{modelValue:a.value,"onUpdate:modelValue":[v[0]||(v[0]=p=>a.value=p),g],options:[3,4,5,6],behavior:"menu"},{prepend:V(()=>[I(k,{name:"lens_blur"})]),_:1},8,["modelValue"]),I(H,null,{default:V(()=>[I(T,{icon:"refresh",onClick:ne}),I(T,{icon:"undo",onClick:x(S)},null,8,["onClick"])]),_:1})])]),i("main",{class:"grid-main",ref_key:"gridRef",ref:o,style:ee(x(d))},[(E(!0),w(B,null,te(a.value*a.value,p=>(E(),w("div",{class:"cell-placeholder",key:p}))),128)),(E(!0),w(B,null,te(x(r),p=>(E(),w("div",{class:ve(["cell",{[`cell-${p.value}`]:!0,"cell-merge":p.state===x(Y).MERGE,"cell-new":p.state===x(Y).NEW}]),key:p.id,style:ee(n(p))},b(p.value),7))),128)),I(ie,{name:"fade"},{default:V(()=>[D(i("div",We,He,512),[[P,x(m)]])]),_:1})],4)])])],64)}}});const Be={class:"game"},Xe=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"game/2048.md","lastUpdated":1675261485000}'),De={name:"game/2048.md"},Ye=Object.assign(De,{setup(e){return(a,r)=>(E(),w("div",null,[i("div",Be,[I(Ve)])]))}});export{Xe as __pageData,Ye as default};
